<!DOCTYPE html>
<html lang="{{ page.lang }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
    <link rel="stylesheet" href="{{ '/assets/css/styles.css' | relative_url }}">
  </head>
  <body>
    <header class="site-header">
      <div class="header-inner">
        <div class="header-left">
          <a class="site-title" href="{{ '/' | relative_url }}">{{ site.title }}</a>
          <div class="search-container">
            <input type="text" id="search-input" placeholder="{{ site.data.ui[page.lang].search_placeholder }}">
            <ul id="search-results"></ul>
          </div>
        </div>
        <nav class="site-nav">
          {% if page.lang == "en" %}
            <a class="nav-link active" href="{{ '/' | relative_url }}">{{ site.data.ui.en.en }}</a>
            <a class="nav-link" href="{{ '/zh' | relative_url }}">{{ site.data.ui.en.zh }}</a>
          {% else %}
            <a class="nav-link" href="{{ '/' | relative_url }}">{{ site.data.ui.zh.en }}</a>
            <a class="nav-link active" href="{{ '/zh' | relative_url }}">{{ site.data.ui.zh.zh }}</a>
          {% endif %}
        </nav>
      </div>
    </header>

    <main>
      {{ content }}
    </main>

    <footer class="site-footer">
      <div class="footer-inner">
        <div class="footer-content">
          © {{ site.time | date: '%Y' }} {{ site.title }}
        </div>
      </div>
    </footer>

    <!-- Simple Jekyll Search -->
    <script src="https://unpkg.com/simple-jekyll-search@latest/dest/simple-jekyll-search.min.js"></script>
    <script>
      // 初始化搜索
      const searchInput = document.getElementById('search-input');
      const searchResults = document.getElementById('search-results');
      
      SimpleJekyllSearch({
        searchInput: searchInput,
        resultsContainer: searchResults,
        json: '/search.json',
        searchResultTemplate: '<li><a href="{url}">{title}</a></li>',
        noResultsText: '{{ site.data.ui[page.lang].no_results }}',
        limit: 10,
        fuzzy: false,
        success: function() {
          // 当搜索结果更新时显示结果容器
          searchResults.classList.add('visible');
        }
      });

      // 点击外部时隐藏搜索结果
      document.addEventListener('click', function(event) {
        const isClickInside = searchInput.contains(event.target) || searchResults.contains(event.target);
        if (!isClickInside) {
          searchResults.classList.remove('visible');
        }
      });

      // 当搜索框为空时隐藏结果
      searchInput.addEventListener('input', function() {
        if (!this.value) {
          searchResults.classList.remove('visible');
        }
      });

      // 点击搜索框时，如果有内容则显示结果
      searchInput.addEventListener('click', function() {
        if (this.value && searchResults.children.length > 0) {
          searchResults.classList.add('visible');
        }
      });
    </script>
  </body>
</html> 